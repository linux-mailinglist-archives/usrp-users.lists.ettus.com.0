Return-Path: <usrp-users-bounces@lists.ettus.com>
X-Original-To: lists+usrp-users@lfdr.de
Delivered-To: lists+usrp-users@lfdr.de
Received: from mm2.emwd.com (mm2.emwd.com [172.104.30.75])
	by mail.lfdr.de (Postfix) with ESMTPS id 88DD7A3A78
	for <lists+usrp-users@lfdr.de>; Fri, 30 Aug 2019 17:36:57 +0200 (CEST)
Received: from [::1] (port=59038 helo=mm2.emwd.com)
	by mm2.emwd.com with esmtp (Exim 4.92)
	(envelope-from <usrp-users-bounces@lists.ettus.com>)
	id 1i3ixK-0002Ek-SK; Fri, 30 Aug 2019 11:36:54 -0400
Received: from mail-qk1-f180.google.com ([209.85.222.180]:46597)
 by mm2.emwd.com with esmtps (TLSv1.2:ECDHE-RSA-AES128-GCM-SHA256:128)
 (Exim 4.92) (envelope-from <support@ettus.com>) id 1i3ixG-00028u-Ot
 for usrp-users@lists.ettus.com; Fri, 30 Aug 2019 11:36:50 -0400
Received: by mail-qk1-f180.google.com with SMTP id p13so6441770qkg.13
 for <usrp-users@lists.ettus.com>; Fri, 30 Aug 2019 08:36:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=ettus-com.20150623.gappssmtp.com; s=20150623;
 h=mime-version:references:in-reply-to:sender:from:date:message-id
 :subject:to:cc;
 bh=A/2vQsvyduDN95we8prcOy5r/w5ZXRoeeH78aP+ydqQ=;
 b=MR79/FmTU/0OsvN+DmpXGJBAoAiRdlkZgVT+8EmUomI5ovqn9kPti0XMhfUhvHddQk
 G2Osk3J1g3XBsoUBaFeIkcZ+pYCKipDMj1BnVu6yiv/nvUWKrS+wKzrbG40euetSEOd8
 MUEV6vb0CTfPRpklaqdDXt4Eq3LTZYELjzVQIgJ5BsoBCOSW6zVIuArU3XeQ3oYY1Irx
 t/7EcBG/3WdVxLT54FpYtug8L38LMwHH0lzC5z8IJBu1kOG2e3xCEEZlXhRMAK/H7sqr
 zj7j+9kWahN/7HL6qUoKk7zCraZymLqNpRAN18CD5ydWL6hL8sTCTW3me879BfIzS+jj
 4cGA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:sender:from
 :date:message-id:subject:to:cc;
 bh=A/2vQsvyduDN95we8prcOy5r/w5ZXRoeeH78aP+ydqQ=;
 b=filqlg1g+U5Vkd2IGLXeM69T2G1ByWCXOSAQVyqPhO37Dq5+4QgV8CJ7hAJXNFkNTZ
 7SgcntMFQ5+LwZZsv4/Yp6ysMBqj+7ovuJQvsKH/0MNYavgUAdJyNNzyHBPj1p4i6Cp/
 jQq6EN5JQbuH53iDYoKfDTmzcFZ5waXo8RBwy+PeAY+TATNT9izxgcr4mkrzdrhe73zF
 yombwCZXra7OlYybVVmbNRv1maYjQFltUhUa1PFDypZWPh4wBT1dgvbqIv38mWE/j7J3
 tWgb48YDD48vGjC0o4oqk1mJGjREK7vVrZE1lPQTSr1HVw4/Ji2Wiv/RzUsZS7XY7AF+
 Vvdw==
X-Gm-Message-State: APjAAAXGPGh4O7fwGL3L/PLrurVxeqmA+yQQCFZRVEGiEQ/Be4+aiKnz
 5zJIFlrW1DFHwSdrGnvnUnUxEQx1cC57OGQHs4LumzSc
X-Google-Smtp-Source: APXvYqyW47QGl4uxz2l/vYx22OG/2iKag7E3OaWBJ+242/48jLD3PNWgwsp6+CI4X5dg6zoizAc5EQOO2dYKXwBzIZY=
X-Received: by 2002:a05:620a:786:: with SMTP id
 6mr6766003qka.307.1567179369936; 
 Fri, 30 Aug 2019 08:36:09 -0700 (PDT)
MIME-Version: 1.0
References: <022046f63a5723c6851aee45d88103b2.squirrel@webmail.tu-dortmund.de>
In-Reply-To: <022046f63a5723c6851aee45d88103b2.squirrel@webmail.tu-dortmund.de>
X-Google-Sender-Delegation: sam.reiter@ettus.com
Date: Fri, 30 Aug 2019 10:35:33 -0500
X-Google-Sender-Auth: JXnEBfkEcGjQTLr9939it8h96MI
Message-ID: <CACSOXP13AaQBSCckyLV7tDn6w6DcCOfKaLLHoO570qBqhyzdsQ@mail.gmail.com>
To: felix.greiwe@tu-dortmund.de
Subject: Re: [USRP-users] Phase Sync between to UBX-160 Daugtherboards using
 RFNoC Radio
X-BeenThere: usrp-users@lists.ettus.com
X-Mailman-Version: 2.1.27
Precedence: list
List-Id: USRP-related discussion and support <usrp-users.lists.ettus.com>
List-Unsubscribe: <http://lists.ettus.com/mailman/options/usrp-users_lists.ettus.com>, 
 <mailto:usrp-users-request@lists.ettus.com?subject=unsubscribe>
List-Archive: <http://lists.ettus.com/pipermail/usrp-users_lists.ettus.com/>
List-Post: <mailto:usrp-users@lists.ettus.com>
List-Help: <mailto:usrp-users-request@lists.ettus.com?subject=help>
List-Subscribe: <http://lists.ettus.com/mailman/listinfo/usrp-users_lists.ettus.com>, 
 <mailto:usrp-users-request@lists.ettus.com?subject=subscribe>
From: Ettus Research Support via USRP-users <usrp-users@lists.ettus.com>
Reply-To: Ettus Research Support <support@ettus.com>
Cc: Usrp Liste <usrp-users@lists.ettus.com>
Content-Type: multipart/mixed; boundary="===============2008452988335043651=="
Errors-To: usrp-users-bounces@lists.ettus.com
Sender: "USRP-users" <usrp-users-bounces@lists.ettus.com>
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mm2.emwd.com
X-AntiAbuse: Original Domain - lfdr.de
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - lists.ettus.com
X-Get-Message-Sender-Via: mm2.emwd.com: acl_c_authenticated_local_user: mailman/mailman
X-Authenticated-Sender: mm2.emwd.com: mailman@lists.ettus.com
X-Source: 
X-Source-Args: 
X-Source-Dir: 

--===============2008452988335043651==
Content-Type: multipart/alternative; boundary="000000000000a5109105915761e6"

--000000000000a5109105915761e6
Content-Type: text/plain; charset="UTF-8"

Hey Felix,

Your hunch is correct -- you'll need to use timed commands to issue your
tune requests and to initiate streaming. This will involve editing the
python script generated by GRC. Here's a relevant GRC manual section [1],
and an example snippet of tuning with timed commands in the UHD Manual [2].
Doing this correctly should ensure that you are able to keep a consistent
phase offset between your TX channels at a given frequency.

I'm not sure if it'd actually be an issue, but one thing from your
flowgraph struck me. You might want to fork the output of your cosine block
so that both TX streams are being fed data from a single source. I don't
think this will solve your problem, but if the blocks are doing the same
thing, may help take a variable out of the equation.

Sam

[1] https://www.gnuradio.org/doc/doxygen/classgr_1_1uhd_1_1usrp__block.html
[2] https://files.ettus.com/manual/page_sync.html#sync_phase_lo


On Thu, Aug 29, 2019 at 8:49 AM Felix Greiwe via USRP-users <
usrp-users@lists.ettus.com> wrote:

> Hello together,
>
> I am trying to transmit one complex cosine from both TX - Antenna of my
> USRP-x310 with two UBX-160 Daugtherboards. I am transmitting a cosine with
> the frequency of 100 kHz and the center frequency of my RFNoC Radio Blocks
> is 2.45 GHz. So basically I see a peak at 2.45 Ghz + 100 kHz at my
> spectrum analyzer (plus the lo leakage at 2.45 GHz). Additionally I
> receive the spectrum on another x310.
>
> In the following link you can see my flowgraph in GRC:
> https://ibb.co/7W6mTKf
>
> As you can see i have two multiply blocks to change the phase of the
> complex cosines, the value of the multiply blocks are
>
> > pow(math.e, 1j*phi*(math.pi/180)) and
> > pow(math.e, 1j*psi*(math.pi/180)).
>
> I can change phi and psi with a qt gui range slider. Default value ist
> multiplication by 1.
>
> My goal with this setup was to check the MIMO capabilities of the USRP
> x310.
> I calculated the Phase offset both transmitted waves should have at the
> antenna of my spectrum analyzer. With my multiplication blocks I created
> different phase offsets, thus causing destructive interference at the
> receiving end (peak at analyzer is the smallest at this phase).
>
> However most of the time when I start different runs of my flowgraph (or
> when I power cycle the device) I always have to set a different phase
> offset to see the destructive interference. To me it seems pretty random
> which phase offset both transmitting path get even though i don't
> understand why.
>
> In another thread I read that maybe timed tuning will work for me but I
> did not quite understand what that improves in particular nor who I use it
> in my  GRC generated python file. (Using the RFnoC Radio Blocks does not
> make it easier by the way.) This is the link:
>
>
> http://ettus.80997.x6.nabble.com/USRP-users-use-a-usrp-x310-as-MIMO-transmitter-daughterboard-synchronization-tt11642.html
>
> Any ideas, suggestions and explanations on how to phase align the transmit
> path of my (single) USRP x310 would be greatly appreciated!
>
> Best regards
>
> Felix
>
>
>
> _______________________________________________
> USRP-users mailing list
> USRP-users@lists.ettus.com
> http://lists.ettus.com/mailman/listinfo/usrp-users_lists.ettus.com
>

--000000000000a5109105915761e6
Content-Type: text/html; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_default" style=3D"font-family:verdana,=
sans-serif">Hey Felix,</div><div class=3D"gmail_default" style=3D"font-fami=
ly:verdana,sans-serif"><br></div><div class=3D"gmail_default" style=3D"font=
-family:verdana,sans-serif">Your hunch is correct -- you&#39;ll need to use=
 timed commands to issue your tune requests and to initiate streaming. This=
 will involve editing the python script generated by GRC. Here&#39;s a rele=
vant GRC manual section [1], and an example snippet of tuning with timed co=
mmands in the UHD Manual [2]. Doing this correctly should ensure that you a=
re able to keep a consistent phase offset between your TX channels at a giv=
en frequency. <br></div><div class=3D"gmail_default" style=3D"font-family:v=
erdana,sans-serif"><br></div><div class=3D"gmail_default" style=3D"font-fam=
ily:verdana,sans-serif">I&#39;m not sure if it&#39;d actually be an issue, =
but one thing from your flowgraph struck me. You might want to fork the out=
put of your cosine block so that both TX streams are being fed data from a =
single source. I don&#39;t think this will solve your problem, but if the b=
locks are doing the same thing, may help take a variable out of the equatio=
n.<br></div><div class=3D"gmail_default" style=3D"font-family:verdana,sans-=
serif"><br></div><div class=3D"gmail_default" style=3D"font-family:verdana,=
sans-serif">Sam</div><div class=3D"gmail_default" style=3D"font-family:verd=
ana,sans-serif"><br></div><div class=3D"gmail_default" style=3D"font-family=
:verdana,sans-serif">[1] <a href=3D"https://www.gnuradio.org/doc/doxygen/cl=
assgr_1_1uhd_1_1usrp__block.html">https://www.gnuradio.org/doc/doxygen/clas=
sgr_1_1uhd_1_1usrp__block.html</a></div><div class=3D"gmail_default" style=
=3D"font-family:verdana,sans-serif">[2] <a href=3D"https://files.ettus.com/=
manual/page_sync.html#sync_phase_lo">https://files.ettus.com/manual/page_sy=
nc.html#sync_phase_lo</a><br></div><div class=3D"gmail_default" style=3D"fo=
nt-family:verdana,sans-serif"><br></div></div><br><div class=3D"gmail_quote=
"><div dir=3D"ltr" class=3D"gmail_attr">On Thu, Aug 29, 2019 at 8:49 AM Fel=
ix Greiwe via USRP-users &lt;<a href=3D"mailto:usrp-users@lists.ettus.com">=
usrp-users@lists.ettus.com</a>&gt; wrote:<br></div><blockquote class=3D"gma=
il_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,2=
04,204);padding-left:1ex">Hello together,<br>
<br>
I am trying to transmit one complex cosine from both TX - Antenna of my<br>
USRP-x310 with two UBX-160 Daugtherboards. I am transmitting a cosine with<=
br>
the frequency of 100 kHz and the center frequency of my RFNoC Radio Blocks<=
br>
is 2.45 GHz. So basically I see a peak at 2.45 Ghz + 100 kHz at my<br>
spectrum analyzer (plus the lo leakage at 2.45 GHz). Additionally I<br>
receive the spectrum on another x310.<br>
<br>
In the following link you can see my flowgraph in GRC:<br>
<a href=3D"https://ibb.co/7W6mTKf" rel=3D"noreferrer" target=3D"_blank">htt=
ps://ibb.co/7W6mTKf</a><br>
<br>
As you can see i have two multiply blocks to change the phase of the<br>
complex cosines, the value of the multiply blocks are<br>
<br>
&gt; pow(math.e, 1j*phi*(math.pi/180)) and<br>
&gt; pow(math.e, 1j*psi*(math.pi/180)).<br>
<br>
I can change phi and psi with a qt gui range slider. Default value ist<br>
multiplication by 1.<br>
<br>
My goal with this setup was to check the MIMO capabilities of the USRP x310=
.<br>
I calculated the Phase offset both transmitted waves should have at the<br>
antenna of my spectrum analyzer. With my multiplication blocks I created<br=
>
different phase offsets, thus causing destructive interference at the<br>
receiving end (peak at analyzer is the smallest at this phase).<br>
<br>
However most of the time when I start different runs of my flowgraph (or<br=
>
when I power cycle the device) I always have to set a different phase<br>
offset to see the destructive interference. To me it seems pretty random<br=
>
which phase offset both transmitting path get even though i don&#39;t<br>
understand why.<br>
<br>
In another thread I read that maybe timed tuning will work for me but I<br>
did not quite understand what that improves in particular nor who I use it<=
br>
in my=C2=A0 GRC generated python file. (Using the RFnoC Radio Blocks does n=
ot<br>
make it easier by the way.) This is the link:<br>
<br>
<a href=3D"http://ettus.80997.x6.nabble.com/USRP-users-use-a-usrp-x310-as-M=
IMO-transmitter-daughterboard-synchronization-tt11642.html" rel=3D"noreferr=
er" target=3D"_blank">http://ettus.80997.x6.nabble.com/USRP-users-use-a-usr=
p-x310-as-MIMO-transmitter-daughterboard-synchronization-tt11642.html</a><b=
r>
<br>
Any ideas, suggestions and explanations on how to phase align the transmit<=
br>
path of my (single) USRP x310 would be greatly appreciated!<br>
<br>
Best regards<br>
<br>
Felix<br>
<br>
<br>
<br>
_______________________________________________<br>
USRP-users mailing list<br>
<a href=3D"mailto:USRP-users@lists.ettus.com" target=3D"_blank">USRP-users@=
lists.ettus.com</a><br>
<a href=3D"http://lists.ettus.com/mailman/listinfo/usrp-users_lists.ettus.c=
om" rel=3D"noreferrer" target=3D"_blank">http://lists.ettus.com/mailman/lis=
tinfo/usrp-users_lists.ettus.com</a><br>
</blockquote></div>

--000000000000a5109105915761e6--


--===============2008452988335043651==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

_______________________________________________
USRP-users mailing list
USRP-users@lists.ettus.com
http://lists.ettus.com/mailman/listinfo/usrp-users_lists.ettus.com

--===============2008452988335043651==--

